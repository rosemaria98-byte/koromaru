<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>ころまるのだいぼうけん！</title>

<style>
body{
    margin:0;
    background:#87cfff;
    font-family:sans-serif;
    text-align:center;
}

/* タイトル画面（画像背景） */
#title{
    position:fixed;
    width:100%;
    height:100%;
    top:0;
    left:0;
    background:url("title.png") center/cover no-repeat;
    display:flex;
    flex-direction:column;
    justify-content:flex-end;
    align-items:center;
    padding-bottom:80px;
    box-sizing:border-box;
}

button{
    font-size:26px;
    padding:18px 60px;
    border:none;
    border-radius:25px;
    background:#ffcc66;
}

/* ゲーム画面 */
#game{
    display:none;
}

canvas{
    background:#7ad66f;
    touch-action:none;
}
</style>
</head>

<body>

<!-- タイトル -->
<div id="title">
<button onclick="startGame()">スタート！</button>
</div>

<!-- ゲーム -->
<div id="game">
<canvas id="c" width="390" height="650"></canvas>
</div>

<script>
const canvas=document.getElementById("c");
const ctx=canvas.getContext("2d");

let koromaru={x:180,y:500,size:30};
let food=[];
let score=0;

function startGame(){
 document.getElementById("title").style.display="none";
 document.getElementById("game").style.display="block";
 setInterval(update,30);
}

function spawn(){
 food.push({x:Math.random()*360,y:-20});
}

setInterval(spawn,1200);

function update(){
 ctx.clearRect(0,0,390,650);

 //ころまる
 ctx.fillStyle="brown";
 ctx.beginPath();
 ctx.arc(koromaru.x,koromaru.y,koromaru.size,0,Math.PI*2);
 ctx.fill();

 ctx.fillStyle="black";
 ctx.fillText("ころまる",koromaru.x-25,koromaru.y+50);

 //おやつ
 ctx.fillStyle="pink";
 for(let i=0;i<food.length;i++){
   food[i].y+=4;
   ctx.beginPath();
   ctx.arc(food[i].x,food[i].y,15,0,Math.PI*2);
   ctx.fill();

   let dx=food[i].x-koromaru.x;
   let dy=food[i].y-koromaru.y;
   if(Math.sqrt(dx*dx+dy*dy)<40){
       score++;
       food.splice(i,1);
   }
 }

 ctx.fillStyle="black";
 ctx.font="20px sans-serif";
 ctx.fillText("おやつ:"+score,10,30);
}

//タッチで移動
canvas.addEventListener("touchmove",e=>{
 koromaru.x=e.touches[0].clientX-30;
});
</script>

</body>
</html>
